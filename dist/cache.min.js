!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.Cache=b()}(this,function(){var a,b;return function(a,c){b=function(){return"function"==typeof c?c():c}()}(this,function(){var a,b,c="",d=!1,e={PREFIX:"lscache-",SUFFIX:"-cacheexpiration",EXPIRY_RADIX:10,EXPIRY_UNITS:6e4,_supportsStorage:function(){var b="__lscachetest__",c=b;if(void 0!==a)return a;try{e._setItem(b,c),e._removeItem(b),a=!0}catch(d){a=e._isOutOfSpace(d)?!0:!1}return a},_isOutOfSpace:function(a){return a&&"QUOTA_EXCEEDED_ERR"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name||"QuotaExceededError"===a.name?!0:!1},_supportsJSON:function(){return void 0===b&&(b=null!=window.JSON),b},_escapeRegExpSpecialCharacters:function(a){return a.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")},_expirationKey:function(a){return a+e.SUFFIX},_currentTime:function(){return Math.floor((new Date).getTime()/e.EXPIRY_UNITS)},_getMaxDate:function(){return e._maxDate=e._maxDate||Math.floor(864e13/e.EXPIRY_UNITS),e._maxDate},_getItem:function(a){return localStorage.getItem(e.PREFIX+c+a)},_setItem:function(a,b){localStorage.removeItem(e.PREFIX+c+a),localStorage.setItem(e.PREFIX+c+a,b)},_removeItem:function(a){localStorage.removeItem(e.PREFIX+c+a)},_eachKey:function(a){for(var b=new RegExp("^"+e.PREFIX+e._escapeRegExpSpecialCharacters(c)+"(.*)"),d=localStorage.length-1;d>=0;--d){var f=localStorage.key(d);f=f&&f.match(b),f=f&&f[1],f&&f.indexOf(e.SUFFIX)<0&&a(f,e._expirationKey(f))}},_flushItem:function(a){var b=e._expirationKey(a);e._removeItem(a),e._removeItem(b)},_flushExpiredItem:function(a){var b=e._expirationKey(a),c=e._getItem(b);if(c){var d=parseInt(c,e.EXPIRY_RADIX);if(e._currentTime()>=d)return e._removeItem(a),e._removeItem(b),!0}},_warn:function(a,b){d&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+a),b&&window.console.warn("lscache - The error was: "+b.message))},set:function(a,b,c){if(e._supportsStorage()){if("string"!=typeof b){if(!e._supportsJSON())return;try{b=JSON.stringify(b)}catch(d){return}}try{e._setItem(a,b)}catch(d){if(!e._isOutOfSpace(d))return void e._warn("Could not add item with key '"+a+"'",d);var f,g=[];e._eachKey(function(a,b){var c=e._getItem(b);c=c?parseInt(c,e.EXPIRY_RADIX):e._getMaxDate(),g.push({key:a,size:(e._getItem(a)||"").length,expiration:c})}),g.sort(function(a,b){return b.expiration-a.expiration});for(var h=(b||"").length;g.length&&h>0;)f=g.pop(),e._warn("Cache is full, removing item with key '"+a+"'"),e._flushItem(f.key),h-=f.size;try{e._setItem(a,b)}catch(d){return void e._warn("Could not add item with key '"+a+"', perhaps it's too big?",d)}}c?e._setItem(e._expirationKey(a),(e._currentTime()+c).toString(e.EXPIRY_RADIX)):e._removeItem(e._expirationKey(a))}},get:function(a){if(!e._supportsStorage())return null;if(e._flushExpiredItem(a))return null;var b=e._getItem(a);if(!b||!e._supportsJSON())return b;try{return JSON.parse(b)}catch(c){return b}},remove:function(a){e._supportsStorage()&&e._flushItem(a)},supported:function(){return e._supportsStorage()},flush:function(){e._supportsStorage()&&e._eachKey(function(a){e._flushItem(a)})},flushExpired:function(){e._supportsStorage()&&e._eachKey(function(a){e._flushExpiredItem(a)})},setBucket:function(a){c=a},resetBucket:function(){c=""},enableWarnings:function(a){d=a}};return e}),a=function(a){var c=b,d=function(a){a=a||{},this.namespace=a.namespace,this.bucket=a.bucket,this.ttl=a.ttl};return d.prototype.bucketId=function(){var a="";return this.namespace&&(a+=this.namespace+"-"),this.bucket&&(a+=this.bucket+"-"),a},d.prototype.get=function(){return c.setBucket(this.bucketId()),c.get.apply(c,arguments)},d.prototype.set=function(a,b,d){return c.setBucket(this.bucketId()),c.set.call(c,a,b,d||this.ttl)},d.prototype.remove=function(){return c.setBucket(this.bucketId()),c.remove.apply(c,arguments)},d.prototype.flush=function(){return c.setBucket(this.bucketId()),c.flush.apply(c,arguments)},d.prototype.flushExpired=function(){return c.setBucket(this.bucketId()),c.flushExpired.apply(c,arguments)},d.prototype.all=function(){var a={};return c.setBucket(this.bucketId()),c._eachKey(function(b,d){a[b]=c._getItem(b)}),a},d}({})});